# Example cc-allow configuration

version = "2.0"

# ============================================================================
# BASH TOOL CONFIGURATION
# ============================================================================

[bash]
default = "ask"                              # "allow", "deny", or "ask" when no rule matches
dynamic_commands = "ask"                     # commands with $VAR or $(cmd) as the name
default_message = "Command not allowed"       # fallback message when rule has no message

[bash.constructs]
subshells = "ask"
function_definitions = "deny"
background = "ask"

# Quick lists for the most common patterns
[bash.deny]
commands = ["dd", "mkfs", "shutdown", "reboot", "kill", "killall", "sudo"]
message = "This command is in the deny list"

[bash.allow]
commands = ["ls", "cat", "echo", "grep", "find", "head", "tail", "wc", "sort", "uniq", "pwd", "date"]

# ============================================================================
# DETAILED RULES (evaluated in order, first match wins)
# ============================================================================

# Deny curl piped to shell
[[bash.deny.curl]]
message = "Piping curl output to a shell is not allowed"
pipe.to = ["bash", "sh", "zsh", "source", "eval"]

# Deny wget piped to shell
[[bash.deny.wget]]
message = "Piping wget output to a shell is not allowed"
pipe.to = ["bash", "sh", "zsh"]

# Allow curl for general use
[[bash.allow.curl]]

# Allow wget for general use
[[bash.allow.wget]]

# Deny rm with recursive flags
[[bash.deny.rm]]
message = "Recursive rm is not allowed"
args.any = ["-r", "-rf", "-fr", "--recursive"]

# ============================================================================
# REDIRECT RULES
# ============================================================================

# Deny redirecting to sensitive paths
[[bash.redirects.deny]]
message = "Cannot redirect to system directories"
paths = ["path:/etc/*", "path:/var/*", "path:/usr/*"]

# Deny appending to shell configs
[[bash.redirects.deny]]
message = "Cannot modify shell configuration files"
append = true
paths = [".bashrc", ".zshrc", ".profile", ".bash_profile"]
