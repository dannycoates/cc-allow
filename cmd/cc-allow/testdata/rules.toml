# Example cc-allow configuration

version = "1.0"

[policy]
default = "ask"                              # "allow", "deny", or "ask" when no rule matches
dynamic_commands = "ask"                     # commands with $VAR or $(cmd) as the name
default_message = "Command not allowed"       # fallback message when rule has no message

# Quick lists for the most common patterns
[commands.deny]
names = ["dd", "mkfs", "shutdown", "reboot", "kill", "killall", "sudo"]
message = "This command is in the deny list"

[commands.allow]
names = ["ls", "cat", "echo", "grep", "find", "head", "tail", "wc", "sort", "uniq", "pwd", "date"]

# Constructs configuration
[constructs]
subshells = "ask"
function_definitions = "deny"
background = "ask"

# Detailed rules (evaluated in order, first match wins)

# Deny curl piped to shell
[[rule]]
command = "curl"
action = "deny"
message = "Piping curl output to a shell is not allowed"
[rule.pipe]
to = ["bash", "sh", "zsh", "source", "eval"]

# Deny wget piped to shell
[[rule]]
command = "wget"
action = "deny"
message = "Piping wget output to a shell is not allowed"
[rule.pipe]
to = ["bash", "sh", "zsh"]

# Allow curl for general use
[[rule]]
command = "curl"
action = "allow"

# Allow wget for general use
[[rule]]
command = "wget"
action = "allow"

# Deny rm with recursive flags
[[rule]]
command = "rm"
action = "deny"
message = "Recursive rm is not allowed"
[rule.args]
any_match = ["-r", "-rf", "-fr", "--recursive"]

# Redirect rules

# Deny redirecting to sensitive paths
[[redirect]]
action = "deny"
message = "Cannot redirect to system directories"
[redirect.to]
pattern = ["path:/etc/*", "path:/var/*", "path:/usr/*"]

# Deny appending to shell configs
[[redirect]]
action = "deny"
message = "Cannot modify shell configuration files"
append = true
[redirect.to]
exact = [".bashrc", ".zshrc", ".profile", ".bash_profile"]
