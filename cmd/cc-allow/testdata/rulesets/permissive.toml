# Permissive ruleset - allows most things, only blocks truly dangerous commands

[policy]
default = "allow"
dynamic_commands = "pass"
default_message = "Command not allowed"

[commands.deny]
names = ["sudo", "su", "dd", "mkfs", "shutdown", "reboot"]
message = "System-level command denied"

[constructs]
function_definitions = "allow"
background = "allow"
subshells = "allow"

# Block curl/wget piped to shell
[[rule]]
command = "curl"
action = "deny"
message = "No piping curl to shell"
[rule.pipe]
to = ["bash", "sh", "zsh", "eval"]

[[rule]]
command = "wget"
action = "deny"
message = "No piping wget to shell"
[rule.pipe]
to = ["bash", "sh", "zsh", "eval"]

# Block writes to sensitive paths
[[redirect]]
action = "deny"
message = "Cannot write to system paths"
[redirect.to]
pattern = ["re:^/etc/.*", "re:^/usr/.*", "re:^/bin/.*", "re:^/sbin/.*"]
