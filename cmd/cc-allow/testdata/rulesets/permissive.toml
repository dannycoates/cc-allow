# Permissive ruleset - allows most things, only blocks truly dangerous commands

version = "2.0"

# ============================================================================
# BASH TOOL CONFIGURATION
# ============================================================================

[bash]
default = "allow"
dynamic_commands = "ask"
default_message = "Command not allowed"

[bash.constructs]
function_definitions = "allow"
background = "allow"
subshells = "allow"

# ============================================================================
# DENIED COMMANDS
# ============================================================================

[bash.deny]
commands = ["sudo", "su", "dd", "mkfs", "shutdown", "reboot"]
message = "System-level command denied"

# ============================================================================
# SPECIFIC RULES - Block shells from receiving piped input from download commands
# This catches both direct (curl | bash) and indirect (curl | cat | bash) pipes
# ============================================================================

[[bash.deny.bash]]
message = "bash cannot receive piped input from download commands"
pipe.from = ["curl", "wget"]

[[bash.deny.sh]]
message = "sh cannot receive piped input from download commands"
pipe.from = ["curl", "wget"]

[[bash.deny.zsh]]
message = "zsh cannot receive piped input from download commands"
pipe.from = ["curl", "wget"]

# ============================================================================
# REDIRECTS - Block writes to sensitive paths
# ============================================================================

[[bash.redirects.deny]]
message = "Cannot write to system paths"
paths = ["re:^/etc/.*", "re:^/usr/.*", "re:^/bin/.*", "re:^/sbin/.*"]
