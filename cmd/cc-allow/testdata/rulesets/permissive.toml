# Permissive ruleset - allows most things, only blocks truly dangerous commands

[policy]
default = "allow"
dynamic_commands = "ask"
default_message = "Command not allowed"

[commands.deny]
names = ["sudo", "su", "dd", "mkfs", "shutdown", "reboot"]
message = "System-level command denied"

[constructs]
function_definitions = "allow"
background = "allow"
subshells = "allow"

# Block shells from receiving piped input from download commands
# This catches both direct (curl | bash) and indirect (curl | cat | bash) pipes
[[rule]]
command = "bash"
action = "deny"
message = "bash cannot receive piped input from download commands"
[rule.pipe]
from = ["curl", "wget"]

[[rule]]
command = "sh"
action = "deny"
message = "sh cannot receive piped input from download commands"
[rule.pipe]
from = ["curl", "wget"]

[[rule]]
command = "zsh"
action = "deny"
message = "zsh cannot receive piped input from download commands"
[rule.pipe]
from = ["curl", "wget"]

# Block writes to sensitive paths
[[redirect]]
action = "deny"
message = "Cannot write to system paths"
[redirect.to]
pattern = ["re:^/etc/.*", "re:^/usr/.*", "re:^/bin/.*", "re:^/sbin/.*"]
