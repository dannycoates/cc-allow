# Strict ruleset - denies most things, only allows safe read-only commands

version = "1.0"

[policy]
default = "deny"
dynamic_commands = "deny"
default_message = "Command not allowed by strict policy"

# ============================================================================
# ALLOWED COMMANDS
# ============================================================================

[allow]
commands = ["ls", "cat", "head", "tail", "wc", "pwd", "date", "echo", "printf", "grep", "cd"]

# ============================================================================
# DENIED COMMANDS
# ============================================================================

[deny]
commands = ["sudo", "su", "rm", "rmdir", "dd", "mkfs", "shutdown", "reboot", "kill", "killall"]
message = "Dangerous command denied"

# ============================================================================
# SHELL CONSTRUCTS
# ============================================================================

[constructs]
function_definitions = "deny"
background = "deny"
subshells = "ask"
heredocs = "deny"

# ============================================================================
# SPECIFIC RULES
# ============================================================================

[[deny.curl]]
message = "Network commands not allowed"

[[deny.wget]]
message = "Network commands not allowed"

# ============================================================================
# REDIRECTS
# ============================================================================

[[redirect]]
action = "deny"
message = "Redirects not allowed"
[redirect.to]
pattern = ["re:.*"]
