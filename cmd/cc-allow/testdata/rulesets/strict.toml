# Strict ruleset - denies most things, only allows safe read-only commands

version = "2.0"

# ============================================================================
# BASH TOOL CONFIGURATION
# ============================================================================

[bash]
default = "deny"
dynamic_commands = "deny"
default_message = "Command not allowed by strict policy"

[bash.constructs]
function_definitions = "deny"
background = "deny"
subshells = "ask"
heredocs = "deny"

# ============================================================================
# ALLOWED COMMANDS
# ============================================================================

[bash.allow]
commands = ["ls", "cat", "head", "tail", "wc", "pwd", "date", "echo", "printf", "grep", "cd"]

# ============================================================================
# DENIED COMMANDS
# ============================================================================

[bash.deny]
commands = ["sudo", "su", "rm", "rmdir", "dd", "mkfs", "shutdown", "reboot", "kill", "killall"]
message = "Dangerous command denied"

# ============================================================================
# SPECIFIC RULES
# ============================================================================

[[bash.deny.curl]]
message = "Network commands not allowed"

[[bash.deny.wget]]
message = "Network commands not allowed"

# ============================================================================
# REDIRECTS
# ============================================================================

[[bash.redirects.deny]]
message = "Redirects not allowed"
paths = ["re:.*"]
