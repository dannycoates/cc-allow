# File permission ruleset for testing Read, Write, Edit tools

version = "2.0"

# ============================================================================
# READ TOOL CONFIGURATION
# ============================================================================

[read]
default = "ask"
default_message = "File read requires approval: {{.FilePath}}"

[read.allow]
paths = [
    "path:/project/**",
    "path:/home/user/docs/**",
    "path:**/*.md",
    "path:**/*.txt",
]

[read.deny]
paths = [
    "path:/etc/**",
    "path:/secrets/**",
    "path:**/.env*",
    "path:**/*.key",
    "path:**/*.pem",
    "re:.*password.*",
]
message = "Cannot read sensitive file: {{.FilePath}}"

# ============================================================================
# WRITE TOOL CONFIGURATION
# ============================================================================

[write]
default = "ask"
default_message = "File write requires approval: {{.FilePath}}"

[write.allow]
paths = [
    "path:/project/**",
    "path:/tmp/**",
]

[write.deny]
paths = [
    "path:/etc/**",
    "path:/usr/**",
    "path:/bin/**",
    "path:/sbin/**",
    "path:**/.env*",
    "path:**/*.key",
]
message = "Cannot write to system or sensitive files"

# ============================================================================
# EDIT TOOL CONFIGURATION
# ============================================================================

[edit]
default = "ask"
default_message = "File edit requires approval: {{.FilePath}}"

[edit.allow]
paths = [
    "path:/project/**",
]

[edit.deny]
paths = [
    "path:/etc/**",
    "path:**/.env*",
]
message = "Cannot edit sensitive file: {{.FilePath}}"
